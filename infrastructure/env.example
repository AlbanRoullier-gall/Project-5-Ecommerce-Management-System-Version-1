# Variables d'environnement pour l'architecture microservices e-commerce
# Configuration Docker Compose - Architecture Microservices

#------------------------------------------------------------------------------
# CONFIGURATION GÉNÉRALE
#------------------------------------------------------------------------------

# Environnement de développement
NODE_ENV=development

# Clé secrète JWT pour l'authentification
JWT_SECRET=your-jwt-secret-key

#------------------------------------------------------------------------------
# CONFIGURATION API GATEWAY
#------------------------------------------------------------------------------

# Port d'exposition de l'API Gateway
API_GATEWAY_PORT=13000

# URLs des microservices (communication interne Docker)
CUSTOMER_SERVICE_URL=http://customer-service:3001
PRODUCT_SERVICE_URL=http://product-service:3002
ORDER_SERVICE_URL=http://order-service:3003
CART_SERVICE_URL=http://cart-service:3004
WEBSITE_CONTENT_SERVICE_URL=http://website-content-service:3005

#------------------------------------------------------------------------------
# CONFIGURATION DES BASES DE DONNÉES POSTGRESQL
#------------------------------------------------------------------------------

# Customer Service Database
CUSTOMER_DB_NAME=customer_db
CUSTOMER_DB_HOST=customer-db
CUSTOMER_DB_PORT=5432
CUSTOMER_DB_USER=customer_user
CUSTOMER_DB_PASSWORD=customer_password
CUSTOMER_DATABASE_URL=postgresql://customer_user:customer_password@customer-db:5432/customer_db

# Product Service Database
PRODUCT_DB_NAME=product_db
PRODUCT_DB_HOST=product-db
PRODUCT_DB_PORT=5432
PRODUCT_DB_USER=product_user
PRODUCT_DB_PASSWORD=product_password
PRODUCT_DATABASE_URL=postgresql://product_user:product_password@product-db:5432/product_db

# Order Service Database
ORDER_DB_NAME=order_db
ORDER_DB_HOST=order-db
ORDER_DB_PORT=5432
ORDER_DB_USER=order_user
ORDER_DB_PASSWORD=order_password
ORDER_DATABASE_URL=postgresql://order_user:order_password@order-db:5432/order_db


# Website Content Service Database
WEBSITE_CONTENT_DB_NAME=website_content_db
WEBSITE_CONTENT_DB_HOST=content-db
WEBSITE_CONTENT_DB_PORT=5432
WEBSITE_CONTENT_DB_USER=content_user
WEBSITE_CONTENT_DB_PASSWORD=content_password
WEBSITE_CONTENT_DATABASE_URL=postgresql://content_user:content_password@content-db:5432/website_content_db



#------------------------------------------------------------------------------
# CONFIGURATION DES PORTS D'EXPOSITION
#------------------------------------------------------------------------------

# Ports d'exposition des services (accès externe)
API_GATEWAY_EXTERNAL_PORT=13000
CUSTOMER_SERVICE_EXTERNAL_PORT=13001
PRODUCT_SERVICE_EXTERNAL_PORT=13002
ORDER_SERVICE_EXTERNAL_PORT=13003
CART_SERVICE_EXTERNAL_PORT=13004
WEBSITE_CONTENT_SERVICE_EXTERNAL_PORT=13005

# Ports d'exposition des bases de données (accès externe)
CUSTOMER_DB_EXTERNAL_PORT=15432
PRODUCT_DB_EXTERNAL_PORT=15433
ORDER_DB_EXTERNAL_PORT=15434
WEBSITE_CONTENT_DB_EXTERNAL_PORT=15436

#------------------------------------------------------------------------------
# CONFIGURATION FRONTEND
#------------------------------------------------------------------------------

# URLs d'accès aux services depuis le frontend
NEXT_PUBLIC_API_URL=http://localhost:13000
NEXT_PUBLIC_CUSTOMER_SERVICE_URL=http://localhost:13001
NEXT_PUBLIC_PRODUCT_SERVICE_URL=http://localhost:13002
NEXT_PUBLIC_ORDER_SERVICE_URL=http://localhost:13003
NEXT_PUBLIC_CART_SERVICE_URL=http://localhost:13004
NEXT_PUBLIC_WEBSITE_CONTENT_SERVICE_URL=http://localhost:13005

#------------------------------------------------------------------------------
# CONFIGURATION REDIS
#------------------------------------------------------------------------------

# Configuration Redis pour le cache et les sessions
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=redis://redis:6379


#------------------------------------------------------------------------------
# CONFIGURATION BACKUP
#------------------------------------------------------------------------------

# Configuration des sauvegardes
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true
BACKUP_ENCRYPTION=false

#------------------------------------------------------------------------------
# CONFIGURATION MONITORING
#------------------------------------------------------------------------------

# Configuration des logs
LOG_LEVEL=info
LOG_FORMAT=combined

# Configuration des métriques
METRICS_ENABLED=true
METRICS_PORT=9090

#------------------------------------------------------------------------------
# CONFIGURATION SÉCURITÉ
#------------------------------------------------------------------------------

# Configuration CORS
CORS_ORIGIN=http://localhost:13008,http://localhost:13009,http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# Configuration des headers de sécurité
HELMET_ENABLED=true
RATE_LIMITING_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

#------------------------------------------------------------------------------
# CONFIGURATION DÉVELOPPEMENT
#------------------------------------------------------------------------------

# Configuration pour le développement
DEBUG_MODE=true
HOT_RELOAD=true
AUTO_RESTART=true

# Configuration des tests
TEST_DATABASE_URL=postgresql://test_user:test_password@localhost:5432/test_db
TEST_ENVIRONMENT=testing

#------------------------------------------------------------------------------
# NOTES D'UTILISATION
#------------------------------------------------------------------------------

# 1. Copiez ce fichier vers .env et ajustez les valeurs selon votre environnement
# 2. Les variables DATABASE_URL sont utilisées par les microservices
# 3. Les variables NEXT_PUBLIC_* sont accessibles côté client
# 4. Les ports externes permettent l'accès depuis l'extérieur de Docker
# 5. Les URLs internes (sans localhost) sont utilisées pour la communication entre services
# 6. Le système de backup utilise les conteneurs Docker directement (4 bases de données)
# 7. Redis est utilisé pour le cache et les sessions utilisateur
# 8. Architecture microservices avec 4 services et leurs bases PostgreSQL dédiées (Customer, Product, Order, Website Content)